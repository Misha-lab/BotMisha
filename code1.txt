package com.company.view;

import com.company.model.GoodsDatabase;
import com.company.model.Product;

import javax.swing.*;
import java.awt.*;
import java.util.ArrayList;

public class ProductsView extends JPanel {
    private JLayeredPane layeredPane;
    public static final int WIDTH = 900;

    public ProductsView(final Client client, String categoryName, String typeName) {
        setLayout(new FlowLayout());
        layeredPane = new JLayeredPane();
        layeredPane.setLayout(null);
        setForeground(new Color(107,107,107));

        GoodsDatabase goodsDatabase = new GoodsDatabase();
        ArrayList<Product> products = goodsDatabase.loadGoodsFromTypeAndCategory(categoryName, typeName);

        int lpHeight = (products.size() / 4) * (ProductView.HEIGHT+20) + 150;
        layeredPane.setPreferredSize(new Dimension(WIDTH, lpHeight));
        setBounds(client.getContentPane().getWidth() - WIDTH, 0, WIDTH, client.getContentPane().getHeight());
        //setPreferredSize(new Dimension(WIDTH, client.getContentPane().getHeight()));

        JScrollPane pane = new JScrollPane(layeredPane, JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED, JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
        pane.setPreferredSize(new Dimension(WIDTH - 15, client.getHeight()));
        pane.getVerticalScrollBar().setUnitIncrement(16);
        pane.revalidate();
        pane.setBorder(null);

        final ProductView[] panels = new ProductView[products.size()];
        int j = 0;
        for (int i = 0; i < products.size();) {
            panels[i] = new ProductView(products.get(i));
            panels[i].addRatingButtons();
            panels[i].setBounds((panels[i].getWidth() + 20) * (i % 4), (panels[i].getHeight() + 20) * j, panels[i].getWidth(), panels[i].getHeight());
            layeredPane.add(panels[i], Integer.valueOf((10)));
            i++;
            if(i % 4 == 0) {
                j++;
            }
        }
        add(pane);
        revalidate();
    }
}